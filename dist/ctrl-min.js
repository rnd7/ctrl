!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ctrl=e():t.ctrl=e()}(window,function(){return function(t){var e={};function s(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=t,s.c=e,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(r,i,function(e){return t[e]}.bind(null,i));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";function r(t,e){for(var s=0;s<e.length;s++){var r=e[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}s.r(e);var i=2*Math.PI;function n(t,e){return(t%e+e)%e}function o(t,e,s){return Math.min(s||1,Math.max(e||0,t))}function a(t,e,s,r,n,o,a){o=o||0,a=a||i,t.beginPath(),t.arc(e,s,r,o,a,!1),t.arc(e,s,n,a,o,!0),t.closePath()}var h={observeSize:!1,sizeFromParent:!0,eventMode:"value",speed:.01,value:0,disabled:!1,neutralAngle:-(Math.PI/2),borderRadius:2,borderColor:"rgb(12,12,12)",borderFocusColor:"rgb(0,0,80)",backgroundColor:"rgb(36,36,36)",steps:1,stepGap:i/360,trackSize:12,trackSector:.8*i,trackSectorColor:"rgb(66,66,66)",valueSector:i/48,valueSectorColor:"rgb(255,255,255)",targetSector:i/48,targetSectorColor:"rgba(170,170,255,.5)"},u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._canvas=document.createElement("CANVAS"),this._canvas.tabIndex=0,this._canvas.style.outline=0,this._canvas.style.userSelect="none",this._ctx=this._canvas.getContext("2d"),this._target=null,this._mouseX=0,this._mouseY=0,this._mouseAngle=0,this._bound={startDrag:this.startDrag.bind(this),stopDrag:this.stopDrag.bind(this),drag:this.drag.bind(this),focus:this.focus.bind(this),blur:this.blur.bind(this)},Object.assign(this,h,e),null===this.target&&(this.target=this.value),this._canvas.addEventListener("mousedown",this._bound.startDrag),this._canvas.addEventListener("focus",this._bound.focus,!0),this._canvas.addEventListener("blur",this._bound.blur,!0)}return function(t,e,s){e&&r(t.prototype,e),s&&r(t,s)}(t,[{key:"startDrag",value:function(t){this._disabled||(this._dragging=!0,this._canvas.removeEventListener("mousedown",this._bound.startDrag),this._canvas.removeEventListener("touchstart",this._bound.startDrag),document.addEventListener("mousemove",this._bound.drag),document.addEventListener("touchmove",this._bound.drag),document.addEventListener("mouseup",this._bound.stopDrag),document.addEventListener("mouseleave",this._bound.stopDrag),document.addEventListener("dragleave",this._bound.stopDrag),document.addEventListener("touchcancel",this._bound.stopDrag),document.addEventListener("touchend",this._bound.stopDrag),this._evalMousePosition(t))}},{key:"drag",value:function(t){this._disabled||this._evalMousePosition(t)}},{key:"stopDrag",value:function(t){this._disabled||(this._dragging=!1,document.removeEventListener("mousemove",this._bound.drag),document.removeEventListener("touchmove",this._bound.drag),document.removeEventListener("mouseup",this._bound.stopDrag),document.removeEventListener("mouseleave",this._bound.stopDrag),document.removeEventListener("dragleave",this._bound.stopDrag),document.removeEventListener("touchcancel",this._bound.stopDrag),document.removeEventListener("touchend",this._bound.stopDrag),this._canvas.addEventListener("mousedown",this._bound.startDrag),this._canvas.addEventListener("touchstart",this._bound.startDrag),this._evalMousePosition(t))}},{key:"focus",value:function(t){this._disabled||(this._focus=!0,this.redraw())}},{key:"blur",value:function(t){this._disabled||(this._focus=!1,this.redraw())}},{key:"on",value:function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this._canvas.addEventListener.apply(this._canvas,e)}},{key:"addEventListener",value:function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this._canvas.addEventListener.apply(this._canvas,e)}},{key:"off",value:function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this._canvas.removeEventListener.apply(this._canvas,e)}},{key:"removeEventListener",value:function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this._canvas.removeEventListener.apply(this._canvas,e)}},{key:"fitParent",value:function(){this._parent&&(this._width=this._parent.offsetWidth,this._height=this._parent.offsetHeight,this._resizeCanvas())}},{key:"redraw",value:function(){this._redraw=!0,this._loop()}},{key:"_resizeCanvas",value:function(){this._canvasSize=Math.min(this._width,this._height),this._radius=this._canvasSize/2,this._centerX=this._centerY=this._radius,this.redraw()}},{key:"_attachDomElement",value:function(){this.parent&&this._canvas&&(this._parent.appendChild(this._canvas),this.fitParent(),this.redraw())}},{key:"_evalMousePosition",value:function(t){this._mouseX=t.touches?t.touches[0].pageX:t.pageX,this._mouseY=t.touches?t.touches[0].pageY:t.pageY,this._mouseAngle=function(t,e,s,r){var n=Math.atan2(r-e,s-t);return n<0&&(n+=i),n}(this._canvas.offsetLeft+this._canvasSize/2,this._canvas.offsetTop+this._canvasSize/2,this._mouseX,this._mouseY);var e=this._neutralAngle-Math.PI,s=(i-(this._trackSector-this._valueSector))/i,r=n(this._mouseAngle-e,i)/i*(i/(this._trackSector-this._valueSector))-(s+this._valueSector/2)/2;this._target=o(r),this.redraw()}},{key:"_dispatchChangeEvent",value:function(){"none"===this._eventMode||"value"===this._eventMode&&this._lastEventValue==this._value||"target"===this._eventMode&&this._lastEventTarget==this._target||"step"===this._eventMode&&this._lastEventStep==this.step||"complete"===this._eventMode&&this._value!=this._target||(this._canvas.dispatchEvent(new CustomEvent("change",{bubbles:!0,detail:{step:this.step,value:this._value,target:this._target,component:this}})),this._lastEventValue=this._value,this._lastEventTarget=this._target,this._lastEventStep=this.step)}},{key:"_loop",value:function(){var t=this;!this._animationFrame&&(this._observeSize||this._dragging||this._redraw||this._value!=this._target)&&(this._animationFrame=window.requestAnimationFrame(function(){var e=t._dragging||t._redraw;t._value!=t._target&&(t.speed<=0?t._value=t._target:t._value+t._speed<=t._target?t._value+=t._speed:t._value-t._speed>=t._target?t._value-=t._speed:t._value=t._target,e=!0,t._dispatchChangeEvent()),t._observeSize&&t._sizeFromParent&&(t._parent.offsetWidth!=t._width||t._parent.offsetHeight!=t._height)&&(t.fitParent(),e=!0),t._animationFrame=null,e&&t._draw(),t._loop()}))}},{key:"_draw",value:function(){var t,e,s=this._ctx,r=this._centerX,o=this._centerY,h=this._borderRadius,u=Math.min(this._radius/3,this._trackSize),c=-this._trackSector/2+this._neutralAngle,_=c+this._trackSector,l=function(t,e){var s=n(t-e,i),r=n(e-t,i);return s<r?-s:r}(c,_),d=this._target,v=this._value,f=this._radius-h,g=this._radius-h-u;if(s.canvas.width!=this._canvasSize||s.canvas.height!=this._canvasSize?s.canvas.width=s.canvas.height=this._canvasSize:s.clearRect(0,0,this._canvasSize,this._canvasSize),s.save(),s.beginPath(),s.fillStyle=this._focus?this._borderFocusColor:this._borderColor,s.arc(r,o,this._radius,0,i),s.arc(r,o,g-h,0,i,!0),s.clip(),s.fill(),s.restore(),s.fillStyle=this._backgroundColor,a(s,r,o,f,g),s.fill(),this._steps<2)s.fillStyle=this._trackSectorColor,a(s,r,o,f,g,c,_),s.fill(),v!=d&&(e=(t=d*(i+l-this._targetSector)+c)+this._targetSector,s.fillStyle=this._targetSectorColor,a(s,r,o,f,g,t,e),s.fill()),e=(t=v*(i+l-this._valueSector)+c)+this._valueSector,s.fillStyle=this._valueSectorColor,a(s,r,o,f,g,t,e),s.fill();else for(var p=this._trackSector/this._steps,b=1/this._steps,m=0;m<this._steps;m++)t=n(c+p*m,i)+this._stepGap,e=n(c+p*(m+1),i)-this._stepGap,s.fillStyle=this._trackSectorColor,a(s,r,o,f,g,t,e),s.fill(),v>=m*b&&v<=(m+1)*b?(s.fillStyle=this._valueSectorColor,a(s,r,o,f,g,t,e),s.fill()):v!=d&&d>=m*b&&d<=(m+1)*b&&(s.fillStyle=this._targetSectorColor,a(s,r,o,f,g,t,e),s.fill());this._redraw=!1}},{key:"eventMode",set:function(t){this._eventMode=t},get:function(){return this._eventMode}},{key:"selector",set:function(t){this._selector=t,this.parent=document.querySelector(this._selector)},get:function(){return this._selector}},{key:"parent",set:function(t){this._parent=t,this._attachDomElement()},get:function(){return this._parent}},{key:"value",set:function(t){this._value!=t&&(this._value=o(t),this.redraw())},get:function(){return this._value}},{key:"trackSector",set:function(t){this._trackSector!=t&&(this._trackSector=t,this.redraw())},get:function(){return this._trackSector}},{key:"target",set:function(t){this._target!=t&&(this._target=o(t),this.redraw())},get:function(){return this._target}},{key:"steps",set:function(t){this._steps!=t&&(this._steps=Math.max(1,t),this.redraw())},get:function(){return this._steps}},{key:"step",get:function(){return Math.floor(this._value*this._steps)},set:function(t){this.value=t/this._steps}},{key:"neutralAngle",set:function(t){this._neutralAngle!=t&&(this._neutralAngle=t,this.redraw())},get:function(){return this._neutralAngle}},{key:"sizeFromParent",set:function(t){this._sizeFromParent!=t&&(this._sizeFromParent=t,this._sizeFromParent&&this.fitParent())},get:function(){return this._sizeFromParent}},{key:"width",set:function(t){this._width!=t&&(this._width=t,this._resizeCanvas())},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this._resizeCanvas())},get:function(){return this._height}},{key:"speed",set:function(t){this._speed!=t&&(this._speed=t)},get:function(){return this._speed}},{key:"targetSector",set:function(t){this._targetSector!=t&&(this._targetSector=t,this.redraw())},get:function(){return this._targetSector}},{key:"valueSector",set:function(t){this._valueSector!=t&&(this._valueSector=t,this.redraw())},get:function(){return this._valueSector}},{key:"stepGap",set:function(t){this._stepGap!=t&&(this._stepGap=t,this.redraw())},get:function(){return this._stepGap}},{key:"disabled",set:function(t){this._disabled!=t&&(this._disabled=t,this._disabled&&this._dragging&&this.stopDrag(),this._disabled&&this._focus&&this.blur(),this.redraw())},get:function(){return this._disabled}},{key:"observeSize",set:function(t){this._observeSize!=t&&(this._observeSize=t,this._observeSize&&this._loop())},get:function(){return observeSize}},{key:"borderRadius",set:function(t){this._borderRadius!=t&&(this._borderRadius=t,this.redraw())},get:function(){return this._borderRadius}},{key:"trackSize",set:function(t){this._trackSize!=t&&(this._trackSize=t,this.redraw())},get:function(){return this._trackSize}},{key:"valueSectorColor",set:function(t){this._valueSectorColor!=t&&(this._valueSectorColor=t,this.redraw())},get:function(){return this._valueSectorColor}},{key:"trackSectorColor",set:function(t){this._trackSectorColor!=t&&(this._trackSectorColor=t,this.redraw())},get:function(){return this._trackSectorColor}},{key:"borderColor",set:function(t){this._borderColor!=t&&(this._borderColor=t,this.redraw())},get:function(){return this._borderColor}},{key:"borderFocusColor",set:function(t){this._borderFocusColor!=t&&(this._borderFocusColor=t,this.redraw())},get:function(){return this._borderFocusColor}},{key:"backgroundColor",set:function(t){this._backgroundColor!=t&&(this._backgroundColor=t,this.redraw())},get:function(){return this._backgroundColor}},{key:"targetSectorColor",set:function(t){this._targetSectorColor!=t&&(this._targetSectorColor=t,this.redraw())},get:function(){return this._targetSectorColor}},{key:"domElement",get:function(){return this._canvas}}]),t}();s.d(e,"Rotary",function(){return u})}])});
//# sourceMappingURL=ctrl-min.js.map